{"version":3,"sources":["../../src/models/service.js"],"names":[],"mappings":"0WAAA,IAAM,WAAW,QAAQ,SAAR,EAAmB,QAApC;AACI,UAAU,QAAQ,MAAR,CADd;;AAGA,OAAO,OAAP,GAAiB;AACb;AACA,+FAAQ,iBAAe,GAAf;AACE,eADF,mJACc,QAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC,GAApC,CADd,QACE,GADF;AAEG,+BAFH,gEAAR,6EAFa;;;AAOb;AACA,gGAAQ,kBAAe,GAAf;AACE,eADF,wJACc,QAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC,GAApC,CADd,QACE,GADF;AAEG,+BAFH,kEAAR,+EARa;;;AAab;AACA,gGAAQ,kBAAe,EAAf;AACE,eADF,wJACc,QAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC;AAClD,qCAAK,IAAI,QAAJ,CAAa,EAAb,CAD6C,EAApC,CADd,QACE,GADF;;AAIG,+BAJH,kEAAR,+EAda;;;AAqBb;AACA,8FAAM,kBAAe,KAAf,EAAsB,MAAtB;AACI,eADJ,wJACgB,QAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,KAAlC,EAAyC,MAAzC,CADhB,QACI,GADJ;AAEK,+BAFL,kEAAN,gFAtBa;;;AA2Bb;AACA,iGAAS,kBAAe,KAAf,EAAsB,MAAtB;AACC,eADD,wJACa,QAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC,KAArC,EAA4C,MAA5C,CADb,QACC,GADD;AAEE,+BAFF,kEAAT,sFA5Ba;;;AAiCb;AACA,gGAAQ;AACE,eADF,wJACc,QAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,EAAlC,CADd,QACE,GADF,kFAAR,4EAlCa;;;AAsCb;AACA,iGAAS,kBAAe,EAAf;AACC,eADD,wJACa,QAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC;AACnD,qCAAK,IAAI,QAAJ,CAAa,EAAb,CAD8C,EAArC,CADb,QACC,GADD,kFAAT,iFAvCa;;;;AA6Cb;AACA,kGAAU,kBAAe,GAAf,EAAoB,MAApB;;;;AAIA,eAJA,8HACN,MAAM,IAAI,GAAJ,CAAQ,UAAU,EAAV,EAAc,CACxB,IAAI,QAAJ,CAAa,EAAb,EACH,CAFK,CAAN,CADM,0BAIY,QAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC;AAChD,qCAAK;AACD,yCAAK,GADJ,EAD2C,EAAlC;;AAIf,kCAJe,CAJZ,QAIA,GAJA;AASC,+BATD,kEAAV,yFA9Ca;;;AA0Db;AACA,mGAAW,kBAAe,KAAf,EAAsB,IAAtB,EAA4B,QAA5B,EAAsC,OAAtC;;;;;AAKD,kBALC;;;;;AAUD,eAVC,8HACP,IAAI,CAAC,KAAL,EAAY,QAAQ,EAAR,CACZ,IAAI,CAAC,IAAL,EAAW,OAAO,CACd,CAAC,KAAD,EAAQ,MAAR,CADc,CAAP,CAGL,MALC,GAKQ,EACX,MAAM,IADK,EAEX,OAAO,QAFI,EAGX,MAAM,CAAC,UAAU,CAAX,IAAgB,QAHX,EALR,2BAUW,QAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,KAAlC,EAAyC,MAAzC,CAVX,QAUD,GAVC;AAWA,+BAXA,kEAAX,wGA3Da;;;AAyEb;AACA,gGAAO,mBAAe,KAAf;;AAEG,eAFH,kIACH,IAAI,CAAC,KAAL,EAAY,QAAQ,EAAR,CADT,2BAEe,QAAQ,KAAR,CAAc,KAAK,cAAnB,EAAmC,KAAnC,CAFf,QAEG,GAFH,qFAAP,+EA1Ea,EAAjB","file":"service.js","sourcesContent":["const ObjectID = require('mongodb').ObjectID,\r\n    mongodb = require('./db')\r\n\r\nmodule.exports = {\r\n    // 创建\r\n    insert: async function(obj) {\r\n        const res = await mongodb.insert(this.collectionName, obj)\r\n        return res\r\n    },\r\n\r\n    // 更新\r\n    update: async function(obj) {\r\n        const res = await mongodb.update(this.collectionName, obj)\r\n        return res\r\n    },\r\n\r\n    // 删除\r\n    remove: async function(id) {\r\n        const res = await mongodb.remove(this.collectionName, {\r\n            _id: new ObjectID(id)\r\n        })\r\n        return res\r\n    },\r\n\r\n    // 查询多条\r\n    find: async function(query, option) {\r\n        const res = await mongodb.find(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 查询单条\r\n    findOne: async function(query, option) {\r\n        const res = await mongodb.findOne(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 获取全部\r\n    getAll: async function() {\r\n        const res = await mongodb.find(this.collectionName, {})\r\n    },\r\n\r\n    // 按id查询\r\n    getById: async function(id) {\r\n        const res = await mongodb.findOne(this.collectionName, {\r\n            _id: new ObjectID(id)\r\n        })\r\n    },\r\n\r\n    // 按照很多id来查询\r\n    getByIds: async function(ids, option) {\r\n        ids = ids.map(function (id) {\r\n            new ObjectID(id)\r\n        })\r\n        const res = await mongodb.find(this.collectionName, {\r\n            _id: {\r\n                $in: ids\r\n            }\r\n        }, option)\r\n        return res\r\n    },\r\n\r\n    // 列出(带分页)\r\n    getByPage: async function(query, sort, pageSize, pageNum) {\r\n        if (!query) query = {}\r\n        if (!sort) sort = [\r\n            ['_id', 'desc']\r\n        ]\r\n        const option = {\r\n            sort: sort,\r\n            limit: pageSize,\r\n            skip: (pageNum - 1) * pageSize\r\n        }\r\n        const res = await mongodb.find(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 计数\r\n    count: async function(query) {\r\n        if (!query) query = {}\r\n        const res = await mongodb.count(this.collectionName, query)\r\n    }\r\n}\r\n"]}